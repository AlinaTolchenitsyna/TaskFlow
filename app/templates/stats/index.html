{% extends "base.html" %}

{% block content %}
<h2>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>

<div class="row">
    <div class="col-md-6">
        <canvas id="pieChart"></canvas>
    </div>
    <div class="col-md-6">
        <canvas id="lineChart"></canvas>
    </div>
</div>

<hr>
<p>
    –í—Å–µ–≥–æ –∑–∞–¥–∞—á: <b>{{ total }}</b><br>
    –í—ã–ø–æ–ª–Ω–µ–Ω–æ: <b>{{ done }}</b><br>
    –û—Ç–∫—Ä—ã—Ç—ã–µ: <b>{{ open_tasks }}</b>
</p>

<!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    // –ö—Ä—É–≥–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞
    const ctxPie = document.getElementById('pieChart').getContext('2d');
    new Chart(ctxPie, {
        type: 'doughnut',
        data: {
            labels: ['–í—ã–ø–æ–ª–Ω–µ–Ω–æ', '–û—Ç–∫—Ä—ã—Ç—ã–µ'],
            datasets: [{
                data: [{{ done }}, {{ open_tasks }}],
                backgroundColor: ['#28a745', '#dc3545'],
            }]
        }
    });

    // –õ–∏–Ω–µ–π–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π)
    const ctxLine = document.getElementById('lineChart').getContext('2d');
    new Chart(ctxLine, {
        type: 'line',
        data: {
            labels: {{ days | tojson }},
            datasets: [{
                label: '–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏',
                data: {{ daily_counts | tojson }},
                borderColor: '#007bff',
                fill: false,
                tension: 0.2
            }]
        }
    });
</script>
{% endblock %}
